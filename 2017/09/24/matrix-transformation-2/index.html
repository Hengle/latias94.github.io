<!DOCTYPE html>
<html lang="zh-Hans">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="3D数学基础-矩阵变换（二）"/>




  <meta name="keywords" content="3D数学, 游戏开发, 萤火之森" />










  <link rel="alternate" href="/atom.xml" title="萤火之森">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.6.0" />



<link rel="canonical" href="http://frankorz.com/2017/09/24/matrix-transformation-2/"/>


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.6.0" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />




  
  <script id="baidu_analytics">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?91a6af339098c7b3314fd48d6640bbf8";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>



  <script id="google_analytics">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-69634396-1', 'auto');
        ga('send', 'pageview');
  </script>


  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>





  <script src="//cdn1.lncld.net/static/js/3.1.1/av-min.js"></script>
  <script id="leancloud">
    AV.init({
      appId: "v6QgYmEcmbiM4ijI41WdeQSg-gzGzoHsz",
      appKey: "Kfe1eyGyevT3hHuiDfm8Hw1G"
    });
  </script>





    <title> 3D数学基础-矩阵变换（二） - 萤火之森 </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">萤火之森</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            标签
          
        </li>
      </a>
    
      <a href="/categories">
        <li class="mobile-menu-item">
          
          
            分类
          
        </li>
      </a>
    
      <a href="/leetcode">
        <li class="mobile-menu-item">
          
          
            LeetCode
          
        </li>
      </a>
    
      <a href="/resume">
        <li class="mobile-menu-item">
          
          
            简历
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">萤火之森</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              分类
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/leetcode">
            
            
              LeetCode
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/resume">
            
            
              简历
            
          </a>
        </li>
      
    </ul>
  
</nav>

      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          3D数学基础-矩阵变换（二）
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-09-24
        </span>
        
          <div class="post-category">
            
              <a href="/categories/图形学/">图形学</a>
            
          </div>
        
        
        <div class="post-visits"
             data-url="/2017/09/24/matrix-transformation-2/"
             data-title="3D数学基础-矩阵变换（二）">
            阅读次数
          </div>
        
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#平移（Translation）"><span class="toc-text">平移（Translation）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#齐次坐标"><span class="toc-text">齐次坐标</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组合平移和旋转变换"><span class="toc-text">组合平移和旋转变换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#先平移再旋转"><span class="toc-text">先平移再旋转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#先旋转再平移"><span class="toc-text">先旋转再平移</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#法线变换"><span class="toc-text">法线变换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#法线（Normal）"><span class="toc-text">法线（Normal）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#改变坐标系"><span class="toc-text">改变坐标系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考资料"><span class="toc-text">参考资料</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <p>上一篇笔记<a href="http://frankorz.com/2017/09/22/basic-of-vector-and-matrix-transformation/">3D数学基础-向量运算基础和矩阵变换</a>记录了一些向量和矩阵运算的基础，和一些矩阵基本的变换。这篇笔记主要介绍了平移变换、齐次坐标、平移和旋转变换的组合、法线变换和改变坐标系。</p>
<a id="more"></a>
<h2 id="平移（Translation）"><a href="#平移（Translation）" class="headerlink" title="平移（Translation）"></a>平移（Translation）</h2><p>前一篇文章总结了旋转、缩放等变换，这里介绍一下平移变换。</p>
<p>假如我们需要把X坐标从 x 变换到 x+5，我们需要构造什么样的变换矩阵来实现平移呢？</p>
<p><img src="http://latex.codecogs.com/png.latex?%5Cbegin%7Bbmatrix%7Dx%27%20%5C%5C%20y%27%20%5C%5C%20z%27%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20%26%20%26%20%5C%5C%20%26%20%3F%20%26%20%5C%5C%20%26%20%26%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7Dx%20%5C%5C%20y%20%5C%5C%20z%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7Dx&plus;5%20%5C%5C%20y%20%5C%5C%20z%20%5Cend%7Bbmatrix%7D" alt=""></p>
<p>要注意的是，变换矩阵不能包含 x、y、z 等坐标变量。例如要得到 x+5，那么矩阵的第一个行向量不能是<img src="http://latex.codecogs.com/svg.latex?%281%2C0%2C5/z%29" alt="">，因为变换的一个重要性质是<strong>变换矩阵保持不变</strong>。</p>
<p>我们可以给矩阵多加一个维度 w，令其等于1，这样就不需要用到 x、y、z 这些坐标变量了。</p>
<p><img src="http://latex.codecogs.com/png.latex?%5Cbegin%7Bbmatrix%7Dx%27%20%5C%5C%20y%27%20%5C%5C%20z%27%20%5C%5C%20w%27%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%201%20%26%200%20%26%200%20%26%205%5C%5C%200%20%26%201%20%26%200%20%26%200%5C%5C%200%20%26%200%20%26%201%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7Dx%20%5C%5C%20y%20%5C%5C%20z%20%5C%5C%201%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7Dx&plus;5%20%5C%5C%20y%20%5C%5C%20z%20%5C%5C%201%20%5Cend%7Bbmatrix%7D" alt=""></p>
<p>这里引用到了<a href="https://www.wikiwand.com/zh/%E9%BD%90%E6%AC%A1%E5%9D%90%E6%A0%87" target="_blank" rel="noopener">齐次坐标</a>的概念。</p>
<h2 id="齐次坐标"><a href="#齐次坐标" class="headerlink" title="齐次坐标"></a>齐次坐标</h2><blockquote>
<p>齐次坐标表示是计算机图形学的重要手段之一，它既能够用来明确区分向量和点，同时也更易用于进行仿射几何变换。<br>—— F.S. Hill, JR 《计算机图形学(OpenGL版)》作者</p>
</blockquote>
<p>想要了解三维坐标是怎么样扩展到四维坐标，可以先了解下二维空间中的齐次坐标<img src="http://latex.codecogs.com/svg.latex?%28x%2Cy%2Cw%29" alt="">。</p>
<p>下图的三维坐标中在 w=1 处有一个二维平面，则该平面上的二维平面坐标可以表示为<img src="http://latex.codecogs.com/svg.latex?%28x%2Cy%2C1%29" alt="">，图中的<img src="http://latex.codecogs.com/svg.latex?%281.0%2C0.8%2C1.0%29" alt="">就是一个在该二维平面上的点。对于不在二维平面上的点，我们则将其投影到二维平面上，所以齐次坐标<img src="http://latex.codecogs.com/svg.latex?%28x%2Cy%2Cw%29" alt="">映射到实际二维平面上的点为<img src="http://latex.codecogs.com/svg.latex?%28x/w%2Cy/w%29" alt="">，例如另外一个点<img src="http://latex.codecogs.com/svg.latex?%282.5%2C2.0%2C2.5%29" alt="">在 w=1 二维平面投影得到的点为<img src="http://latex.codecogs.com/svg.latex?%281.0%2C0.8%29" alt="">。</p>
<p><img src="https://i.loli.net/2017/09/23/59c657c43c5dd.png" alt=""></p>
<p>同理，三维空间的点可以认为是在四维空间中 w=1 的“平面”上，所以齐次坐标<img src="http://latex.codecogs.com/svg.latex?%28x%2Cy%2Cz%2Cw%29" alt="">映射到三维空间上的点为<img src="http://latex.codecogs.com/svg.latex?%28x/w%2Cy/w%2Cz/w%29" alt="">，这也就是点的非齐次坐标。</p>
<p><img src="http://latex.codecogs.com/png.latex?P%3D%5Cbegin%7Bbmatrix%7Dx%20%5C%5C%20y%20%5C%5C%20z%20%5C%5C%20w%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7Dx/w%20%5C%5C%20y/w%20%5C%5C%20z/w%20%5C%5C%201%20%5Cend%7Bbmatrix%7D" alt=""></p>
<p>四维齐次坐标的任何常量缩放会得到相同的结果，也就是说，它包含了点的非齐次坐标所有可能的缩放（还记得上面图中的两个点吗？），w 可以等于任何数值：</p>
<ul>
<li>如果 w &gt; 0，这表示一个真实物理世界的点，我们可以用 x，y，z 三个坐标除以 w 得到这个真实的点。</li>
<li>如果 w = 0，这表示一个无穷远处的点。在实际应用中，通常表示一个向量。</li>
</ul>
<p>齐次坐标的优点：</p>
<ul>
<li>让我们可以同时考虑所有的变换，如平移、观察、旋转、透视投影等。（如果我们要做缩放变换，可以直接变换 x、y、z 的值并且保持 w 不变。）</li>
<li>整个渲染管线都以 4*4 的齐次坐标矩阵以及对应的四维向量为基础，只有在最后要表示真实点的位置的时候，才需要把齐次坐标变为非齐次。（计算机里除法是个非常复杂的操作，需要花费更多的时间周期，但齐次坐标只需在渲染管线最后一步做除法。）</li>
<li>不会出现特殊情况。有时考虑判断直线是否相交，当它们平行的时候，有些公式会出错，但无穷远点已经在齐次坐标中约定了 w=0。</li>
<li>四阶矩阵和齐次坐标是计算机图形软件和硬件中普遍使用的标准。</li>
</ul>
<p>下面表示的是一个点向量加上一个平移变量：</p>
<p><img src="http://latex.codecogs.com/png.latex?P%7B%7D%27%3DTP%3D%5Cbegin%7Bbmatrix%7D%201%20%26%200%20%26%200%20%26%20T_%7Bx%7D%5C%5C%200%20%26%201%20%26%200%20%26%20T_%7By%7D%5C%5C%200%20%26%200%20%26%201%20%26%20T_%7Bz%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7Dx%20%5C%5C%20y%20%5C%5C%20z%20%5C%5C%201%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7Dx&plus;T_%7Bx%7D%20%5C%5C%20y&plus;T_%7By%7D%20%5C%5C%20z&plus;T_%7Bz%7D%20%5C%5C%201%20%5Cend%7Bbmatrix%7D%3DP&plus;T" alt=""></p>
<p>有时候平移矩阵 T 内的左上角部分会直接用单位矩阵来表示，<img src="http://latex.codecogs.com/svg.latex?I_%7B3%7D" alt="">表示 3 * 3 的单位矩阵。</p>
<p><img src="http://latex.codecogs.com/svg.latex?T%3D%5Cbegin%7Bbmatrix%7D%201%20%26%200%20%26%200%20%26%20T_%7Bx%7D%5C%5C%200%20%26%201%20%26%200%20%26%20T_%7By%7D%5C%5C%200%20%26%200%20%26%201%20%26%20T_%7Bz%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20I_%7B3%7D%20%26%20T%5C%5C%200%20%26%201%20%5Cend%7Bbmatrix%7D" alt=""></p>
<h2 id="组合平移和旋转变换"><a href="#组合平移和旋转变换" class="headerlink" title="组合平移和旋转变换"></a>组合平移和旋转变换</h2><p>当要对一个点进行两种变换的时候，就会涉及到变换顺序的问题，是先平移再旋转，还是先旋转再平移？</p>
<h3 id="先平移再旋转"><a href="#先平移再旋转" class="headerlink" title="先平移再旋转"></a>先平移再旋转</h3><p><img src="http://latex.codecogs.com/svg.latex?P%7B%7D%27%3D%5Cleft%20%28%20TR%20%5Cright%20%29P%3DMP%3DRP&plus;T" alt=""></p>
<p>其中 T 为平移矩阵，R 为旋转矩阵，矩阵 P 通过平移再旋转后得到矩阵 P’。注意，在上面的公式中做的是标准的向量计算，在计算时才用齐次坐标计算。</p>
<p><img src="http://latex.codecogs.com/svg.latex?M%3D%5Cbegin%7Bbmatrix%7D%201%20%26%200%20%26%200%20%26%20T_%7Bx%7D%5C%5C%200%20%26%201%20%26%200%20%26%20T_%7By%7D%5C%5C%200%20%26%200%20%26%201%20%26%20T_%7Bz%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%20R_%7B11%7D%20%26%20R_%7B12%7D%20%26%20R_%7B13%7D%20%26%200%5C%5C%20R_%7B21%7D%20%26%20R_%7B22%7D%20%26%20R_%7B23%7D%20%26%200%5C%5C%20R_%7B31%7D%20%26%20R_%7B32%7D%20%26%20R_%7B33%7D%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20R_%7B11%7D%20%26%20R_%7B12%7D%20%26%20R_%7B13%7D%20%26%20T_%7Bx%7D%5C%5C%20R_%7B21%7D%20%26%20R_%7B22%7D%20%26%20R_%7B23%7D%20%26%20T_%7By%7D%5C%5C%20R_%7B31%7D%20%26%20R_%7B32%7D%20%26%20R_%7B33%7D%20%26%20T_%7Bz%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20R%20%26%20T%20%5C%5C%200%20%26%201%20%5Cend%7Bbmatrix%7D" alt=""></p>
<p><img src="http://latex.codecogs.com/svg.latex?MP%3D%5Cbegin%7Bbmatrix%7D%20R%20%26%20T%20%5C%5C%200%20%26%201%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%20P%20%26%200%20%5C%5C%200%20%26%201%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20RP%20%26%20T%20%5C%5C%200%20%26%201%20%5Cend%7Bbmatrix%7D%3DRP&plus;T" alt=""></p>
<h3 id="先旋转再平移"><a href="#先旋转再平移" class="headerlink" title="先旋转再平移"></a>先旋转再平移</h3><p><img src="http://latex.codecogs.com/svg.latex?P%7B%7D%27%3D%28RT%29P%3DMP%3DR%28P&plus;T%29%3DRP&plus;RT" alt=""></p>
<p><img src="http://latex.codecogs.com/svg.latex?M%3D%5Cbegin%7Bbmatrix%7D%20R_%7B11%7D%20%26%20R_%7B12%7D%20%26%20R_%7B13%7D%20%26%200%5C%5C%20R_%7B21%7D%20%26%20R_%7B22%7D%20%26%20R_%7B23%7D%20%26%200%5C%5C%20R_%7B31%7D%20%26%20R_%7B32%7D%20%26%20R_%7B33%7D%20%26%200%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%201%20%26%200%20%26%200%20%26%20T_%7Bx%7D%5C%5C%200%20%26%201%20%26%200%20%26%20T_%7Bx%7D%5C%5C%200%20%26%200%20%26%201%20%26%20T_%7Bx%7D%5C%5C%200%20%26%200%20%26%200%20%26%201%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20R_%7B3%5Ctimes%203%7D%20%26%20R_%7B3%5Ctimes%203%7DT_%7B3%5Ctimes%201%7D%5C%5C%200_%7B1%5Ctimes%203%7D%20%26%201%20%5Cend%7Bbmatrix%7D" alt=""></p>
<p><img src="http://latex.codecogs.com/svg.latex?MP%3D%5Cbegin%7Bbmatrix%7D%20R_%7B3%5Ctimes%203%7D%20%26%20R_%7B3%5Ctimes%203%7DT_%7B3%5Ctimes%201%7D%5C%5C%200_%7B1%5Ctimes%203%7D%20%26%201%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%20P%20%26%200%5C%5C%200%20%26%201%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20RP%20%26%20RT%5C%5C%200%20%26%201%20%5Cend%7Bbmatrix%7D%3DRP&plus;RT" alt=""></p>
<p>对比先平移再旋转的结果，可以看到不同的地方是 T 变成了 RT，也就是说旋转也施加在了平移的方向上。在下图中可看到小人在 Y 轴方向发生了平移，所以<strong>先旋转再平移</strong>可能会更容易得到理想的结果，但两种变换组合都是可行的。（在 gluLookAt 的推导中需要先做平移，gluLookAt 是 OpenGL 中观察变换的一个关键函数。）</p>
<p><img src="https://ooo.0o0.ooo/2017/09/24/59c771e4d39f0.png" alt=""></p>
<h2 id="法线变换"><a href="#法线变换" class="headerlink" title="法线变换"></a>法线变换</h2><p>在图形学中曲面法线的方向也很重要。</p>
<h3 id="法线（Normal）"><a href="#法线（Normal）" class="headerlink" title="法线（Normal）"></a>法线（Normal）</h3><blockquote>
<p>法线是始终垂直于某平面的虚线。在数学几何中法线指平面上垂直于曲线在某点的切线的一条线。<br>——百度百科</p>
</blockquote>
<p><img src="https://i.loli.net/2017/09/24/59c6f8e40b986.png" alt=""></p>
<p>切线的位置实际上就是曲面上的几何位置，因此它们的变换矩阵和曲面的变换矩阵保持一致。</p>
<p><img src="http://latex.codecogs.com/svg.latex?t%5Crightarrow%20Mt" alt=""></p>
<p>而法线变换是另外一个矩阵，我们称之为Q。</p>
<p><img src="http://latex.codecogs.com/svg.latex?n%5Crightarrow%20Qn%7E%7EQ%3D%3F" alt=""></p>
<p>法线必须垂直于这些切线，因此法线和切线的点积等于0。</p>
<p><img src="http://latex.codecogs.com/svg.latex?n%5E%7BT%7Dt%3D0" alt=""></p>
<p>变换后法线和切点依然互相垂直，可得：</p>
<p><img src="http://latex.codecogs.com/svg.latex?%28Qn%29%5E%7BT%7D%3D%28n%5E%7BT%7DQ%5E%7BT%7D%29%28Mt%29%3D0" alt=""></p>
<p>在该等式中，只有当 <img src="http://latex.codecogs.com/svg.latex?Q%5E%7BT%7DM%3DI" alt=""> 时，矩阵才容易求解。</p>
<p><img src="http://latex.codecogs.com/svg.latex?n%5E%7BT%7DQ%5E%7BT%7DMt%3D0%7E%7E%5CRightarrow%20%7E%7E%20Q%5E%7BT%7DM%3DI" alt=""></p>
<p>最后可得法线变换公式，其中<img src="http://latex.codecogs.com/svg.latex?M%5E%7B-1%7D" alt="">只对左上角的 3*3矩阵求逆和转置：</p>
<p><img src="http://latex.codecogs.com/svg.latex?Q%3D%28M%5E%7B-1%7D%29%5E%7BT%7D" alt=""></p>
<p>要进行法线变换，这个公式要施加在曲面上所有的法线上。</p>
<p>另外要注意的是法线是一个向量，不会随着平移而改变，因此平移变换对法线没影响。</p>
<h2 id="改变坐标系"><a href="#改变坐标系" class="headerlink" title="改变坐标系"></a>改变坐标系</h2><p><img src="https://i.loli.net/2017/09/24/59c70f36b057b.jpg" alt=""></p>
<p>在图中，点<img src="http://latex.codecogs.com/svg.latex?%282%2C1%29" alt="">要平移到<img src="http://latex.codecogs.com/svg.latex?%281%2C1%29" alt="">处，可以直接把点向左平移，也可以看成是坐标系的改变，将坐标系向右平移。</p>
<p>引出坐标系的概念是因为，在很多情形下，我们需要一个特定的物理位置在不同的坐标系间变换，例如上一篇文章<a href="http://frankorz.com/2017/09/22/basic-of-vector-and-matrix-transformation/#正交坐标系">正交坐标系</a>中所举的例子。下图中，有世界坐标系、相机坐标系和点 P。</p>
<p><img src="https://i.loli.net/2017/09/24/59c72df0ddea8.jpg" alt=""></p>
<p>点 P 在两个坐标系中的坐标是不同的，而在图形学中，我们经常要做这样的变换。</p>
<p><img src="https://i.loli.net/2017/09/24/59c72e3657a2a.jpg" alt=""></p>
<p>如果我们在世界坐标系中有一个点，要计算出其在相机坐标系中的位置，则要同时考虑相机旋转的坐标系、相机的位置和观察的位置（视点）。</p>
<p>在<a href="http://frankorz.com/2017/09/22/basic-of-vector-and-matrix-transformation/#二维空间下的旋转">二维空间下的旋转</a>中能看到二维旋转矩阵的推导过程，在此基础上，可以看作坐标系向右旋转了θ度，这样点 P 就在新坐标系中到达目标位置 P’ 了。</p>
<p><img src="https://i.loli.net/2017/09/24/59c73178738e1.jpg" alt=""></p>
<p>这样我们就能通过旋转矩阵来得到新的 uv 坐标系了！</p>
<p><img src="http://latex.codecogs.com/svg.latex?%5Cbegin%7Bbmatrix%7D%20u%5C%5Cv%20%5Cend%7Bbmatrix%7D%3D%5Cbegin%7Bbmatrix%7D%20cos%5Ctheta%20%26%20-sin%5Ctheta%20%5C%5C%20sin%5Ctheta%20%26%20cos%5Ctheta%20%5Cend%7Bbmatrix%7D%5Cbegin%7Bbmatrix%7D%20x%5C%5Cy%20%5Cend%7Bbmatrix%7D" alt=""></p>
<hr>
<p>之前讨论的都是三维的变换，下篇笔记会介绍图形学中的观察（Viewing）。3D 数学基础知识有点枯燥，但这是入门图形魔法的必经之路。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://book.douban.com/subject/1400419/" target="_blank" rel="noopener">3D数学基础：图形与游戏开发</a></li>
<li><a href="https://www.edx.org/course/computer-graphics-uc-san-diegox-cse167x-3" target="_blank" rel="noopener">edx-Computer Graphics</a></li>
</ul>

      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>原文作者: </span>
      <a href="http://frankorz.com">猫冬</a>
    </p>
    <p class="copyright-item">
      <span>原文链接: </span>
      <a href="http://frankorz.com/2017/09/24/matrix-transformation-2/">http://frankorz.com/2017/09/24/matrix-transformation-2/</a>
    </p>
    <p class="copyright-item">
      <span>许可协议: </span>
      
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>



      
      
    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/3D数学/">3D数学</a>
            
              <a href="/tags/游戏开发/">游戏开发</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2017/12/16/greedy-best-find-search/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">寻路算法-贪婪最佳优先算法</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2017/09/22/basic-of-vector-and-matrix-transformation/">
        <span class="next-text nav-default">3D数学基础-向量运算基础和矩阵变换</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:frankorz@qq.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="http://weibo.com/u/1825527674" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
        
          <a href="https://www.zhihu.com/people/zhuang-ming-zhen" class="iconfont icon-zhihu" title="zhihu"></a>
        
      
    
      
    
    
    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>
  <span class="division">|</span>
  <span class="host-by">
    Hosted by <a class="hexo-link" href="https://coding.net/pages">Coding Pages</a>
  </span>
  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2018

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">猫冬</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  <script type="text/javascript">
    var disqus_config = function () {
        this.page.url = 'http://frankorz.com/2017/09/24/matrix-transformation-2/';
        this.page.identifier = '2017/09/24/matrix-transformation-2/';
        this.page.title = '3D数学基础-矩阵变换（二）';
    };
    (function() {
    var d = document, s = d.createElement('script');

    s.src = '//frankorz.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();  
  </script>




    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.6.0"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.6.0"></script>

  <script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618},"display":{"superSample":2,"width":120,"height":240,"position":"left","hOffset":0,"vOffset":-20},"mobile":{"show":false,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
